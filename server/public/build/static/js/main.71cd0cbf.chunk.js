(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{203:function(e,t,a){e.exports=a.p+"static/media/defaultposter.b4e877ba.png"},225:function(e,t,a){e.exports=a(454)},230:function(e,t,a){},454:function(e,t,a){"use strict";a.r(t);var n,r=a(0),i=a.n(r),o=a(4),c=a.n(o),l=(a(230),a(231),a(57)),s=a(48),u=a(23),p=a(24),d=a(32),m=a(31),h=a(33),f=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return i.a.createElement("h1",null,"\u6b22\u8fce\u4f7f\u7528\u7535\u5f71\u7ba1\u7406\u7cfb\u7edf")}}]),t}(i.a.Component),v=a(12),b=a.n(v),y=a(461),g=a(29),E=a(5),w=a(455),C=a(456),j=a(464),O=a(458),x=a(210),k=a(203),I=a.n(k);!function(e){e.isHot="isHot",e.isComing="isComing",e.isClassics="isClassics"}(n||(n={}));var S=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){this.props.onLoad&&this.props.onLoad()}},{key:"getFilterDropDown",value:function(e){var t=this;return i.a.createElement("div",{style:{padding:8}},i.a.createElement(y.a,{style:{width:188,marginBottom:8,display:"block"},value:this.props.condition.key,onChange:function(e){return t.props.onKeyChange(e.target.value)},onPressEnter:this.props.onSearch}),i.a.createElement(g.a,{type:"primary",icon:"search",size:"small",style:{width:90,marginRight:8},onClick:this.props.onSearch},"\u641c\u7d22"),i.a.createElement(g.a,{size:"small",style:{width:90},onClick:function(){t.props.onKeyChange(""),t.props.onSearch()}},"\u91cd\u7f6e"))}},{key:"getColumns",value:function(){var e=this;return[{title:"\u6d77\u62a5",dataIndex:"poster",render:function(e,t){return e?i.a.createElement("img",{className:"tablePoster",src:e,alt:""}):i.a.createElement("img",{className:"tablePoster",src:I.a,alt:""})}},{title:"\u540d\u79f0",dataIndex:"name",filterDropdown:this.getFilterDropDown.bind(this),filterIcon:function(e){return i.a.createElement(E.a,{type:"search",style:{color:e?"#1890ff":void 0}})}},{title:"\u5730\u533a",dataIndex:"areas",render:function(e){return e.join("\uff0c")}},{title:"\u7c7b\u578b",dataIndex:"types",render:function(e){return e.join("\uff0c")}},{title:"\u65f6\u957f",dataIndex:"filmLength",render:function(e){return e+"\u5206\u949f"}},{title:"\u6b63\u5728\u70ed\u6620",dataIndex:"isHot",render:function(t,a){return i.a.createElement(w.a,{checked:t,onChange:function(t){e.props.onSwitchChange(n.isHot,t,a._id)}})}},{title:"\u5373\u5c06\u4e0a\u6620",dataIndex:"isComing",render:function(t,a){return i.a.createElement(w.a,{checked:t,onChange:function(t){e.props.onSwitchChange(n.isComing,t,a._id)}})}},{title:"\u7ecf\u5178\u5f71\u7247",dataIndex:"isClassics",render:function(t,a){return i.a.createElement(w.a,{checked:t,onChange:function(t){e.props.onSwitchChange(n.isClassics,t,a._id)}})}},{title:"\u64cd\u4f5c",dataIndex:"_id",render:function(t){return i.a.createElement("div",null,i.a.createElement(l.b,{to:"/movie/edit/"+t},i.a.createElement(g.a,{type:"primary",size:"small"},"\u7f16\u8f91")),i.a.createElement(C.a,{title:"\u786e\u5b9a\u5220\u9664\u5417?",onConfirm:function(){return b.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,b.a.awrap(e.props.onDelete(t));case 2:j.a.success("\u5220\u9664\u6210\u529f");case 3:case"end":return a.stop()}}))},okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"},i.a.createElement(g.a,{type:"danger",size:"small"},"\u5220\u9664")))}}]}},{key:"getPageConfig",value:function(){return 0!==this.props.total&&{current:this.props.condition.page,pageSize:this.props.condition.limit,total:this.props.total}}},{key:"handleChange",value:function(e){this.props.onChange(e.current)}},{key:"render",value:function(){return i.a.createElement(O.a,{rowKey:"_id",dataSource:this.props.data,columns:this.getColumns(),pagination:this.getPageConfig(),onChange:this.handleChange.bind(this),loading:{spinning:this.props.isLoading,indicator:i.a.createElement(x.a,{tip:"Loading..."}),size:"large"}})}}]),t}(i.a.Component),M=a(114),_=a(113),L=a(82),P=a.n(L),D=function(){function e(){Object(u.a)(this,e)}return Object(p.a)(e,null,[{key:"add",value:function(e){var t,a;return b.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,b.a.awrap(P.a.post("/api/movie",e));case 2:return t=n.sent,a=t.data,n.abrupt("return",a);case 5:case"end":return n.stop()}}))}},{key:"edit",value:function(e,t){var a,n;return b.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,b.a.awrap(P.a.put("/api/movie/"+e,t));case 2:return a=r.sent,n=a.data,r.abrupt("return",n);case 5:case"end":return r.stop()}}))}},{key:"delete",value:function(e){var t,a;return b.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,b.a.awrap(P.a.delete("/api/movie/"+e));case 2:return t=n.sent,a=t.data,n.abrupt("return",a);case 5:case"end":return n.stop()}}))}},{key:"getMovieById",value:function(e){var t,a;return b.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,b.a.awrap(P.a.get("/api/movie/"+e));case 2:return t=n.sent,a=t.data,n.abrupt("return",a);case 5:case"end":return n.stop()}}))}},{key:"getMovies",value:function(e){var t,a;return b.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,b.a.awrap(P.a.get("/api/movie",{params:e}));case 2:return t=n.sent,a=t.data,n.abrupt("return",a);case 5:case"end":return n.stop()}}))}}]),e}();function F(e,t){return{type:"movie_save",payload:{movies:e,total:t}}}function A(e){return{type:"movie_setLoading",payload:e}}function N(e){return{type:"movie_setCondition",payload:e}}function q(e){return{type:"movie_delete",payload:e}}function z(e,t,a){return{type:"movie_switch",payload:{type:e,newVal:t,id:a}}}var H={saveMoviesAction:F,setLoadingAction:A,setConditionAction:N,deleteAction:q,fetchMovies:function(e){return function(t,a){var n,r;return b.a.async((function(i){for(;;)switch(i.prev=i.next){case 0:return t(A(!0)),t(N(e)),n=a().movie.condition,i.next=5,b.a.awrap(D.getMovies(n));case 5:r=i.sent,t(F(r.data,r.total)),t(A(!1));case 8:case"end":return i.stop()}}))}},deleteMovie:function(e){return function(t){return b.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return t(A(!0)),a.next=3,b.a.awrap(D.delete(e));case 3:t(q(e)),t(A(!1));case 5:case"end":return a.stop()}}))}},changeSwitchAction:z,changeSwitch:function(e,t,a){return function(n){return b.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return n(z(e,t,a)),r.next=3,b.a.awrap(D.edit(a,Object(_.a)({},e,t)));case 3:case"end":return r.stop()}}))}}};var R=Object(M.b)((function(e){return e.movie}),(function(e){return{onLoad:function(){e(H.fetchMovies({page:1,limit:6,key:""}))},onSwitchChange:function(t,a,n){e(H.changeSwitch(t,a,n))},onDelete:function(t){return b.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,b.a.awrap(e(H.deleteMovie(t)));case 2:case"end":return a.stop()}}))},onChange:function(t){e(H.fetchMovies({page:t}))},onKeyChange:function(t){e(H.setConditionAction({key:t}))},onSearch:function(){e(H.fetchMovies({page:1}))}}}))(S),T=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return i.a.createElement(R,null)}}]),t}(i.a.Component),V=a(80),B=a(460),K=a(463),U=a(462),G=a(459),J=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={showModal:!1},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"getUploadContent",value:function(){return this.props.value?null:i.a.createElement("div",null,i.a.createElement(E.a,{type:"plus"}),i.a.createElement("div",{className:"ant-upload-text"},"Upload"))}},{key:"getFileList",value:function(){return this.props.value?[{uid:this.props.value,name:this.props.value,url:this.props.value}]:[]}},{key:"handleRequest",value:function(e){var t,a,n;return b.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:return(t=new FormData).append(e.filename,e.file),console.log(e),a=new Request(e.action,{method:"post",body:t}),r.next=6,b.a.awrap(fetch(a).then((function(e){return e.json()})));case 6:(n=r.sent).err?j.a.error(n.err,1):(this.props.onChange&&this.props.onChange(n.data),console.log(n.data));case 8:case"end":return r.stop()}}),null,this)}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(U.a,{visible:this.state.showModal,footer:null,onCancel:function(){e.setState({showModal:!1})}},i.a.createElement("img",{alt:"",style:{width:"100%"},src:this.props.value})),i.a.createElement(G.a,{action:"/api/upload",name:"imgfile",accept:".jpg,.png,.gif,.bmp,.jiff",listType:"picture-card",fileList:this.getFileList(),customRequest:this.handleRequest.bind(this),onRemove:function(){e.props.onChange&&e.props.onChange("")},onPreview:function(){e.setState({showModal:!0})}},this.getUploadContent()))}}]),t}(i.a.Component),Q={labelCol:{span:2},wrapperCol:{span:22}},W=[{label:"\u4e2d\u56fd\u5927\u9646",value:"\u4e2d\u56fd\u5927\u9646"},{label:"\u4e2d\u56fd\u9999\u6e2f",value:"\u4e2d\u56fd\u9999\u6e2f"},{label:"\u4e2d\u56fd\u53f0\u6e7e",value:"\u4e2d\u56fd\u53f0\u6e7e"},{label:"\u7f8e\u56fd",value:"\u7f8e\u56fd"},{label:"\u65e5\u672c",value:"\u65e5\u672c"},{label:"\u6cf0\u56fd",value:"\u6cf0\u56fd"},{label:"\u5370\u5ea6",value:"\u5370\u5ea6"},{label:"\u6cd5\u56fd",value:"\u6cd5\u56fd"},{label:"\u4fc4\u7f57\u65af",value:"\u4fc4\u7f57\u65af"},{label:"\u897f\u73ed\u7259",value:"\u897f\u73ed\u7259"},{label:"\u610f\u5927\u5229",value:"\u610f\u5927\u5229"}],X=V.a.Group,Y=[{label:"\u559c\u5267",value:"\u559c\u5267"},{label:"\u79d1\u5e7b",value:"\u79d1\u5e7b"},{label:"\u6218\u4e89",value:"\u6218\u4e89"},{label:"\u7231\u60c5",value:"\u7231\u60c5"},{label:"\u707e\u96be",value:"\u707e\u96be"},{label:"\u52a8\u4f5c",value:"\u52a8\u4f5c"},{label:"\u6050\u6016",value:"\u6050\u6016"},{label:"\u5947\u5e7b",value:"\u5947\u5e7b"},{label:"\u4f26\u7406",value:"\u4f26\u7406"},{label:"\u5386\u53f2",value:"\u5386\u53f2"},{label:"\u60ac\u7591",value:"\u60ac\u7591"}],Z=V.a.Group,$=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"handleSubmit",value:function(e){var t=this;e.preventDefault(),this.props.form.validateFields((function(e){var a,n;return b.a.async((function(r){for(;;)switch(r.prev=r.next){case 0:if(e){r.next=6;break}return a=t.props.form.getFieldsValue(),r.next=4,b.a.awrap(t.props.onSubmit(a));case 4:(n=r.sent)?j.a.error(n):j.a.success("\u5904\u7406\u6210\u529f",1,(function(){t.props.history.push("/movie")}));case 6:case"end":return r.stop()}}))}))}},{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return i.a.createElement(B.a,Object.assign({onSubmit:this.handleSubmit.bind(this)},Q),i.a.createElement(B.a.Item,{label:"\u7535\u5f71\u540d\u79f0",labelCol:{span:2},wrapperCol:{span:18}},e("name",{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u7535\u5f71\u540d\u79f0"}]})(i.a.createElement(y.a,null))),i.a.createElement(B.a.Item,{label:"\u6d77\u62a5"},e("poster")(i.a.createElement(J,null))),i.a.createElement(B.a.Item,{label:"\u5730\u533a"},e("areas",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u5730\u533a"}]})(i.a.createElement(X,{options:W}))),i.a.createElement(B.a.Item,{label:"\u7c7b\u578b"},e("types",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u7c7b\u578b"}]})(i.a.createElement(Z,{options:Y}))),i.a.createElement(B.a.Item,{label:"\u65f6\u957f\uff08\u5206\u949f\uff09"},e("filmLength",{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u65f6\u957f"}]})(i.a.createElement(K.a,{min:1,step:10}))),i.a.createElement(B.a.Item,{label:"\u6b63\u5728\u70ed\u6620"},e("isHot",{initialValue:!1,valuePropName:"checked"})(i.a.createElement(w.a,null))),i.a.createElement(B.a.Item,{label:"\u5373\u5c06\u4e0a\u6620"},e("isComing",{initialValue:!1,valuePropName:"checked"})(i.a.createElement(w.a,null))),i.a.createElement(B.a.Item,{label:"\u7ecf\u5178\u5f71\u7247"},e("isClassics",{initialValue:!1,valuePropName:"checked"})(i.a.createElement(w.a,null))),i.a.createElement(B.a.Item,{label:"\u63cf\u8ff0"},e("description")(i.a.createElement(y.a.TextArea,null))),i.a.createElement(B.a.Item,{wrapperCol:{span:20,offset:2}},i.a.createElement(g.a,{type:"primary",htmlType:"submit"},"\u63d0\u4ea4")))}}]),t}(i.a.Component);var ee=Object(s.e)(B.a.create({mapPropsToFields:function(e){if(e.movie)return function(e){var t={};for(var a in e)t[a]=B.a.createFormField({value:e[a]});return console.log("\u67e5\u770b",t),t}(e.movie)}})($)),te=function(e){function t(){return Object(u.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(p.a)(t,[{key:"render",value:function(){return i.a.createElement(ee,{onSubmit:function(e){var t;return b.a.async((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,b.a.awrap(D.add(e));case 2:if(!(t=a.sent).data){a.next=7;break}return a.abrupt("return","");case 7:return a.abrupt("return",t.err);case 8:case"end":return a.stop()}}))}})}}]),t}(i.a.Component),ae=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(a=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={movie:void 0},a}return Object(h.a)(t,e),Object(p.a)(t,[{key:"componentDidMount",value:function(){var e;return b.a.async((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,b.a.awrap(D.getMovieById(this.props.match.params.id));case 2:(e=t.sent).data&&this.setState({movie:e.data});case 4:case"end":return t.stop()}}),null,this)}},{key:"render",value:function(){var e=this;return i.a.createElement(ee,{movie:this.state.movie,onSubmit:function(t){var a;return b.a.async((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,b.a.awrap(D.edit(e.props.match.params.id,t));case 2:if(!(a=n.sent).data){n.next=7;break}return n.abrupt("return","");case 7:return n.abrupt("return",a.err);case 8:case"end":return n.stop()}}))}})}}]),t}(i.a.Component),ne=a(457),re=a(154),ie=ne.a.Header,oe=ne.a.Sider,ce=ne.a.Content,le=function(){return i.a.createElement("div",{className:"container"},i.a.createElement(ne.a,null,i.a.createElement(ie,null,i.a.createElement(l.b,{to:"/",className:"header"},"\u732b\u773c\u7535\u5f71\u7ba1\u7406\u7cfb\u7edf")),i.a.createElement(ne.a,null,i.a.createElement(oe,null,i.a.createElement(re.a,{mode:"inline",theme:"dark"},i.a.createElement(re.a.Item,{key:"1"},i.a.createElement(l.b,{to:"/movie"},"\u7535\u5f71\u5217\u8868")),i.a.createElement(re.a.Item,{key:"2"},i.a.createElement(l.b,{to:"/movie/add"},"\u6dfb\u52a0\u7535\u5f71")))),i.a.createElement(ce,null,i.a.createElement("div",{className:"main"},i.a.createElement(s.a,{path:"/",component:f,exact:!0}),i.a.createElement(s.a,{path:"/movie",component:T,exact:!0}),i.a.createElement(s.a,{path:"/movie/add",component:te}),i.a.createElement(s.a,{path:"/movie/edit/:id",component:ae}))))))},se=a(70),ue=a(62),pe={data:[],condition:{page:1,limit:10,key:""},total:0,isLoading:!1,totalPage:0},de=function(e,t){return Object(ue.a)({},e,{data:t.payload.movies,total:t.payload.total,totalPage:Math.ceil(t.payload.total/e.condition.limit)})},me=function(e,t){var a=Object(ue.a)({},e,{condition:Object(ue.a)({},e.condition,{},t.payload)});return a.totalPage=Math.ceil(a.total/a.condition.limit),a},he=function(e,t){return Object(ue.a)({},e,{isLoading:t.payload})},fe=function(e,t){return Object(ue.a)({},e,{data:e.data.filter((function(e){return e._id!==t.payload})),total:e.total-1,totalPage:Math.ceil((e.total-1)/e.condition.limit)})},ve=function(e,t){var a=e.data.find((function(e){return e._id===t.payload.id}));if(!a)return e;var n=Object(ue.a)({},a);n[t.payload.type]=t.payload.newVal;var r=e.data.map((function(e){return e._id===t.payload.id?n:e}));return Object(ue.a)({},e,{data:r})},be=Object(se.c)({movie:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"movie_delete":return fe(e,t);case"movie_save":return de(e,t);case"movie_setLoading":return he(e,t);case"movie_setCondition":return me(e,t);case"movie_switch":return ve(e,t);default:return e}}}),ye=a(220),ge=a.n(ye),Ee=a(221),we=Object(se.d)(be,Object(se.a)(Ee.a,ge.a)),Ce=function(){return i.a.createElement(M.a,{store:we},i.a.createElement(l.a,null,i.a.createElement(s.a,{path:"/",component:le})))};c.a.render(i.a.createElement(Ce,null),document.getElementById("root"))}},[[225,1,2]]]);
//# sourceMappingURL=main.71cd0cbf.chunk.js.map